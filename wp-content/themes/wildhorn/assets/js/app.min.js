// Generated by CoffeeScript 1.6.1
(function(){var $,Controller,ControllerLayout,ControllerMenu,ControllerTabs,Region,RegionAside,RegionAudioplayer,RegionBackground,RegionBlog,RegionCollection,RegionGallery,RegionHalfpage,RegionHome,RegionLoader,RegionMenu,RegionPage,RegionSidebar,RegionSocials,RegionVideo,controllers,regionsEntered,regionsQuitted,resizeCallback,_resizeX,_this=this,__hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};Region=function(){function e(e,t){var n=this;this.$el=e;this.global=t;this.id=_.uniqueId("region_");this.events={listeners:[],on:function(e,t){var n;if(_.isString(e)&&_.isFunction(t)){n={event:e,callback:t};app.events.on(n.event,n.callback);this.listeners.push(n)}return this},off:function(e,t){app.events.off(e,t);return this},clear:function(){var e=this;console.log;_.each(this.listeners,function(e){return app.events.off(e.event,e.callback)});return this},trigger:function(e,t){if(_.isString(e))return app.events.trigger(e,t)}};if(!this.global){this.events.on("view.enter",function(){return n.enter()});this.events.on("view.exit",function(){return n.exit()})}this.init();this}e.prototype.init=function(){return this};e.prototype.enter=function(){this.events.trigger("region.entered",[this]);return this};e.prototype.exit=function(){this.events.trigger("region.quitted",[this]);this.events.clear();return this};return e}();Controller=function(){function e(){}return e}();window.app={config:{baseUrl:mthemes_baseUrl,contentId:"content",debug:jQuery.browser.msie&&parseInt(jQuery.browser.version)<10?!1:!0,debugEvents:!1,pushState:Modernizr.history?!0:!1,ajaxLoad:mthemes_pagesReload?!1:!0},events:new EventEmitter,log:function(e){if(app.config.debug&&console&&console.log)return console.log(e)},utils:{},vars:{}};$=window.jQuery;if(Modernizr.history){window.history.replaceState({url:window.location.href},"");window.addEventListener("popstate",function(e){if(_.isObject(e.state)&&_.isString(e.state.url))return app.events.trigger("history.statechange",[e.state])});app.events.on("history.statechange",function(e){return console.log("url changed in "+e.url)})}app.view={init:function(){var e=this;app.log("app view init");this.elements={};if(app.config.pushState&&app.config.ajaxLoad){app.events.on("history.statechange",function(){var e;e=function(){return app.events.trigger("view.exit")};return _.delay(e,0)});app.events.on("regions.contentRegionsQuitted",function(){var e;e=function(){return app.events.trigger("view.quitted")};return _.delay(e,0)});app.events.on("view.quitted",function(){return e.load()});app.events.on("view.rendered",function(){return e.setAnchors()})}else app.log("history not enabled");app.events.on("regions.contentRegionsEntered",function(){var e;app.log("view entered");e=function(){return app.events.trigger("view.entered")};return _.delay(e,0)});app.events.on("view.rendered",function(){var t,n;e.elements.$content.find('[type="application/rss+xml"],[type="application/rsd+xml"],[type="application/wlwmanifest+xml"],[name="generator"],[rel="canonical"],[rel="shortlink"]').remove();e.elements.$content.animate({scrollTop:"scrollTop",0:0},1e3);t=e.elements.$content.find("#wpadminbar").detach();if(t.length){$("#wpadminbar").remove();$("body:eq(0)").append(t)}n=function(){return app.events.trigger("view.enter")};return _.delay(n,0)});return app.events.on("document.ready",function(){var t;e.title=$("title").text();_.isString(app.config.contentId)&&(e.elements.$content=$("#"+app.config.contentId));t=function(){return app.events.trigger("view.rendered")};return _.delay(t,0)})},setAnchors:function(){var e,t;e=$('a:not(.ab-item):not([data-history-bypass]):not([data-history-set]):not("#comments a")');t=this.title;_.each(e,function(e,n){var r,i,s,o;r=$(e);o=app.utils.parseUrl(r.attr("href"));s=o.path;i=o.host;return _.isString(s)&&_.isArray(s.match(/\.[0-9a-z]{3,}$/))||i!==window.location.host&&!_.isUndefined(i)?r.attr({"data-history-bypass":"true",target:"_blank"}):r.attr("data-history-set",!0).on("click",function(e){var n,r;n=$(this).attr("href");e.preventDefault();if(_.isString(n)&&n.length>0&&n!==window.location.href){r={url:n};window.history.pushState(r,t,n);return app.events.trigger("history.statechange",[r])}})});app.log(""+e.length+" anchors set");return e},load:function(){var e=this;app.log("load a new page");this.elements.$content.load(window.location.href,null,function(e,t,n){if(t==="success"){app.log("page successfully loaded");$("html,body").animate({scrollTop:0});return app.events.trigger("view.rendered")}return app.events.trigger("view.notRendered")});return null}};regionsQuitted=0;regionsEntered=0;app.regions={viewRegions:{global:[],content:[]},init:function(){var e=this;if(app.config.pushState&&app.config.ajaxLoad){app.events.on("history.statechange",function(){regionsQuitted=0;return regionsEntered=0});app.events.on("region.quitted",function(t){var n,r,i;r=t.id;i=e.viewRegions.content.length;_.each(e.viewRegions.content,function(e){if(e.id===r)return regionsQuitted++});if(regionsQuitted===i){n=function(){return app.events.trigger("regions.contentRegionsQuitted")};return _.delay(n,0)}})}app.events.on("region.entered",function(t){var n,r,i;r=t.id;i=e.viewRegions.content.length;_.each(e.viewRegions.content,function(e){if(e.id===r)return regionsEntered++});if(regionsEntered===i){n=function(){return app.events.trigger("regions.contentRegionsEntered")};return _.delay(n,0)}});app.events.on("document.ready",function(){return e.setRegions()});app.events.on("view.rendered",function(){return e.setRegions(!1)});return null},setRegions:function(global){var regions,regionsTot,viewRegions;global==null&&(global=!0);regionsTot=0;viewRegions=[];global=_.isBoolean(global)?global:!0;regions=global?$("[data-region]").not("#"+app.config.contentId+" [data-region]"):$("#"+app.config.contentId+" [data-region]");_.each(regions,function(el,i){var $el,region,regionClassName,regionType;$el=$(el);regionType=$el.attr("data-region").substr(0,1).toUpperCase()+$el.attr("data-region").substr(1).toLowerCase();regionClassName="Region"+regionType;if(eval("typeof "+regionClassName)==="function"){region=new(eval(regionClassName))($el,global);viewRegions.push(region);$el.attr("data-region-id",region.id);regionsTot++;return null}});global?app.regions.viewRegions.global=viewRegions:app.regions.viewRegions.content=viewRegions;app.log(global?""+regionsTot+" global regions set":""+regionsTot+" content regions set");return regionsTot}};controllers=[];app.controllers={init:function(){var e,t=this;e=function(){app.events.trigger("controllers.init");_.each(controllers,function(e){if(_.isFunction(e.init))return e.init()});return null};app.events.on("document.ready",e);return null},get:function(){return controllers},set:function(e){e instanceof Controller&&controllers.push(e);return null}};$(document).on("ready",function(){return app.events.trigger("document.ready")});_resizeX=0;resizeCallback=function(){var e,t;_resizeX++;t=_resizeX;e=function(){if(t===_resizeX)return app.events.trigger("viewport.resize")};return _.delay(e,100)};$(window).on("resize",resizeCallback);app.events.on("app.init",function(){app.regions.init();app.view.init();return app.controllers.init()});app.log("app.init");app.events.trigger("app.init");app.animate=function(e){var t,n,r;if(!_.isObject(e))return!1;if(!_.isString(e.cssClass)||!_.isObject(e.element))return!1;e.element.length&&(e.element=e.element[0]);_.isObject(e.target&&e.target.length&&e.target instanceof jQuery)&&(e.target=e.target[0]);e.$element=$(e.element);n=function(){var e,t,n,r,i,s,o;r=document.createElement("div");o={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};n={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(i in o)r.style[i]!==void 0&&(s=o[i]);for(e in n)r.style[e]!==void 0&&(t=n[e]);return{transitionEnd:s,animationEnd:t}}();if(!_.isString(n.transitionEnd)||!_.isString(n.animationEnd))return!1;r=function(i){var s;i.target.removeEventListener(n.transitionEnd,r,!1);i.target.removeEventListener(n.animationEnd,t,!1);s=_.isElement(e.target)?e.target:e.element;i.target===s&&_.isFunction(e.complete)&&e.complete.apply(e.element,["transition",e.cssClass,e.element]);return null};t=function(i){var s;i.target.removeEventListener(n.transitionEnd,r,!1);i.target.removeEventListener(n.animationEnd,t,!1);s=_.isElement(e.target)?e.target:e.element;i.target===s&&_.isFunction(e.complete)&&e.complete.apply(e.element,["animation",e.cssClass,e.element]);return null};if(_.isElement(e.element)){e.element.addEventListener(n.transitionEnd,r,!1);e.element.addEventListener(n.animationEnd,t,!1);e.$element.toggleClass(e.cssClass)}return!0};app.utils.parseUrl=function(e,t){var n,r,i,s,o,u,a,f;i=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"];r=this.php_js&&this.php_js.ini||{};o=r["phpjs.parse_url.mode"]&&r["phpjs.parse_url.mode"].local_value||"php";a={php:/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};s=a[o].exec(e);f={};n=14;while(n--)s[n]&&(f[i[n]]=s[n]);if(t)return f[t.replace("PHP_URL_","").toLowerCase()];if(o!=="php"){u=r["phpjs.parse_url.queryKey"]&&r["phpjs.parse_url.queryKey"].local_value||"queryKey";a=/(?:^|&)([^&=]*)=?([^&]*)/g;f[u]={};f[i[12]].replace(a,function(e,t,n){if(t)return f[u][t]=n})}delete f.source;return f};app.utils.imagePreload=function(e,t){var n,r;n=document.createElement("img");r=e;!_.isString(e)&&_.isElement(e)&&(r=$(e).attr("src"));if(_.isString(r)){n.setAttribute("src",r);$(n).on("load",function(){app.events.trigger("utils.imagePreload",[r,n]);if(_.isFunction(t))return t.apply(this,[r,n])});return!0}return!1};app.events.on("controllers.init",function(){app.controllers.set(new ControllerLayout);app.controllers.set(new ControllerTabs);return app.controllers.set(new ControllerMenu)});ControllerLayout=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.contentMinHeight=550;t.prototype.init=function(){this.$container=$("#container:eq(0)");this.$html=$("html:eq(0)");this.$header=$("header:eq(0)");this.$footer=$("footer:eq(0)");this.$body=$("body:eq(0)");this.scrollLayout=null;this.removeHtmlMargin();return this};t.prototype.removeHtmlMargin=function(){this.$body.hasClass("admin-bar")&&this.$html[0].setAttribute("style","margin-top: 0 !important");return this};return t}(Controller);ControllerTabs=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){var e=this;app.events.on("view.rendered",function(){return e.set()});this.tabs=[];return this};t.prototype.set=function(){var e=this;this.$tabs=$(".tabs");this.$tabs.length&&this.$tabs.each(function(t,n){var r,i,s,o,u,a,f,l;s=$(n);o=s.find("span.tab-label");r=s.find("div.tab");if(o.length===r.length&&o.length>0){r.filter(":gt(0)").addClass("state-hide");i=$("<div></div>");a=$("<ul></ul>");i.addClass("tabs-label");o.each(function(e,t){var n,r;r=$(t);n=$("<li>"+r.text()+"</li>");n.attr("data-index",e);e>0&&n.addClass("tab-unsel");return a.append(n)});a.append("<li>&nbsp;</li>");i.append(a);s.prepend(i);o.remove();o=s.find(".tabs-label ul li");f=function(n){var r;s=$(n.target);if(s.hasClass("tab-unsel")){t=s.attr("data-index");r=s.parent().parent().parent();return e["switch"](r,t)}};o.on("click",function(e){return f(e)});u=$("<select />");o.each(function(e,t){var n;n=$(t).text();if(e<o.length-1)return u.append("<option value='"+e+"'>"+n+"</option>")});l=function(n){var r;s=$(n.target);r=s.parent();t=s.val();return e["switch"](r,t)};u.on("change",function(e){return l(e)});return s.prepend(u)}});return this};t.prototype["switch"]=function(e,t){var n,r;n=e.find(".tab");r=e.find(".tabs-label ul li");console.log(n);n.not(".state-hide").addClass("state-hide");n.filter(":eq("+t+")").removeClass("state-hide");r.not(".tab-unsel").not(":last-child").addClass("tab-unsel");r.filter(":eq("+t+")").removeClass("tab-unsel");e.find("select:eq(0)").val(t);return this};return t}(Controller);ControllerMenu=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){var e,t,n,r,i=this;this.$container=$("#footer-menu");this.$bar=$("#footer-bar");this.$menu=this.$container.find("> * > ul");r="select-navigation";e=this.getSelectData();t=this.getSelectHtml(e);n="<select id='"+r+"'>"+t+"</select>";this.$bar.append(n);this.$select=this.$bar.find("#"+r);this.$select.on("change",function(e){return i.onSelectChange(e)});app.events.on("history.statechange",function(e){var t,n,r;r=e.url;n=!1;t=i.$select.find("option");t.each(function(e,t){var i;i=$(t);if(i.attr("value")===r)return n=t});if(n){t.removeAttr("selected");return $(n).attr("selected","true")}});return this};t.prototype.setMenuWidth=function(){var e,t,n,r,i,s,o=this;n=this.$icons.css("display");if(n==="block"){r=this.$icons.width();i=this.$menu.parent().parent().width();s=i-r-21;this.$menu.css("width",s)}else this.$menu.css("width","auto");t=null;e=this.$menu.find("> li");e.removeClass("hide");e.each(function(e,n){var r;r=$(n);e===0&&(t=r.position().top);if(r.position().top>t)return r.addClass("hide")});return this};t.prototype.getSelectData=function(e){var t,n,r=this;e==null&&(e=this.$menu);n=[];if(e.length){t=e.find("> li > a");t.each(function(e,t){var i,s,o;i=$(t);s=i.attr("href");s||(s=window.location.href);o={value:s,label:i.text()};_.isElement(i.next()[0])&&i.next()[0].tagName==="UL"&&(o.sub=r.getSelectData(i.next()));return n.push(o)})}return n};t.prototype.getSelectHtml=function(e){var t,n,r=this;n="";t=function(e){var t,i,s;s=e.value===location.href?"selected":"";t="<option "+s+" value='"+e.value+"'>"+e.label+"</option>";if(e.sub){i=r.getSelectHtml(e.sub);e.label=e.label.replace(/\'/g,"&apos;");t+="<optgroup label='"+e.label+"'>"+i+"</optgroup>"}return n+=t};_.each(e,function(e){return t(e)});return n};t.prototype.onSelectChange=function(e){var t,n,r;t=$(e.target);r=t.val();if(typeof r!="undefined")if(app.config.pushState&&app.config.ajaxLoad){n={url:r};window.history.pushState(n,app.view.title,r);app.events.trigger("history.statechange",[n])}else window.location=r;return r};return t}(Controller);RegionAudioplayer=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){var e=this;this.supports={mp3:Modernizr.audio.mp3,ogg:Modernizr.audio.ogg};this.audio=Modernizr.audio.mp3||Modernizr.audio.ogg?!0:!1;this.tracks=typeof mthemes_audioPlayerTracks=="object"&&_.isArray(mthemes_audioPlayerTracks)?mthemes_audioPlayerTracks:null;this.setup=this.audio&&this.tracks&&this.tracks.length?!0:!1;this.index=this.setup?0:null;this.$audio=this.$el.find("audio:eq(0)");this.trackname=this.$el.find("#audioplayer-text");this.$previous=this.$el.find("#audioplayer-previous");this.$next=this.$el.find("#audioplayer-next");this.$pause=this.$el.find("#audioplayer-pause");this.$play=this.$el.find("#audioplayer-play");this.$text=this.$el.find("#audioplayer-text");this.$el.parent().addClass("footer-with-player");this.setTrack();this.$el.addClass("state-pause");this.$play.hammer().on("tap",function(){return e.events.trigger("audioplayer.play")});this.$pause.hammer().on("tap",function(){return e.events.trigger("audioplayer.pause")});this.$previous.hammer().on("tap",function(){return e.events.trigger("audioplayer.previous")});this.$next.hammer().on("tap",function(){return e.events.trigger("audioplayer.next")});this.$audio.on("ended",function(){return e.next()});this.events.on("audioplayer.play",function(){return e.play()});this.events.on("audioplayer.pause",function(){return e.pause()});this.events.on("audioplayer.previous",function(){return e.previous()});this.events.on("audioplayer.next",function(){return e.next()});this.events.on("audioplayer.autoplay",function(){return e.events.trigger("audioplayer.play")});this.events.on("viewport.resize",function(){return e.switchDisplay()});typeof mthemes_audioPlayerAutoplay=="boolean"&&mthemes_audioPlayerAutoplay&&this.events.trigger("audioplayer.play");this.switchDisplay();return this};t.prototype.switchDisplay=function(){var e,t,n,r,i,s,o=this;e=this.$el.parent();t=e.find("#footer-menu > * > ul");r=0;i=this.$el.width();n=e.width()/2;s=e.find("#footer-socials").width()+7;t.find("li").each(function(e,t){return r+=$(t).width()+1});if(i+r+s>n){this.$text.css("display","none");e.addClass("footer-with-audioplayer-without-text");e.removeClass("footer-with-audioplayer-with-text")}else{this.$text.css("display","block");e.addClass("footer-with-audioplayer-with-text");e.removeClass("footer-with-audioplayer-without-text")}return this};t.prototype.resize=function(){var e,t,n,r,i,s=this;e=this.$el.width();r=0;t=function(e,t){var n;n=$(t);r+=n.width();return r+=parseInt(n.css("margin-left"))};this.$el.find(" > * ").not("audio").each(t);n=e-r;i=this.trackname.width()+n-2;this.trackname.width(i);return this};t.prototype.setTrack=function(){var e,t;if(this.setup){t=this.tracks[this.index];this.supports.mp3?this.$audio.attr("src",t.mp3):this.$audio.attr("src",t.ogg);e="<span>"+t.title+"</span>";this.trackname.find("span").remove();this.trackname.append(e);Modernizr.cssanimations?this.trackname.find("span").addClass("state-in"):this.trackname.find("span").animate({opacity:1},{duration:500})}return this};t.prototype.play=function(){this.$audio[0].play();this.$el.removeClass().addClass("state-play");return this};t.prototype.pause=function(){this.$audio[0].pause();this.$el.removeClass().addClass("state-pause");return this};t.prototype.previous=function(){this.index=this.index-1<0?this.tracks.length-1:this.index-1;this.setTrack();this.play();return this};t.prototype.next=function(){this.index=this.index+1===this.tracks.length?0:this.index+1;this.setTrack();this.play();return this};return t}(Region);RegionBackground=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){var e;e=this.$el.detach();$("#container").append(e);this.type=this.$el.attr("data-type");this.type==="images"&&this.setupImages();return this};t.prototype.setupImages=function(){var e,t,n,r,i,s,o,u=this;this.$images=this.$el.find(".background-image");this.delay=this.$el.data("delay");this.imagesUrl=[];r=[];this.$images.addClass("state-init");o=this.$images;for(e=i=0,s=o.length;i<s;e=++i){t=o[e];if(_.isElement(t)){n=$(t).data("src");_.isString(n)&&app.utils.imagePreload(n,function(i){var s,o,a;r.push(n);if(r.length===u.$images.length){a=u.$images;for(e=s=0,o=a.length;s<o;e=++s){t=a[e];if(_.isElement(t)){n=$(t).data("src");u.imagesUrl.push(n)}}return u.setupLoop()}})}}return this};t.prototype.setupLoop=function(){var e=this;this.$images.remove();this.index=0;switch(this.imagesUrl.length){case 0:null;break;case 1:this.setImage();break;default:this.events.on("background.imageSet",function(){return e.setupTimeout()});this.setImage()}return this};t.prototype.setImage=function(){var e,t,n,r,i=this;r=this.imagesUrl[this.index];n=$("<div>").addClass("background-image state-init state-over").css("background-image","url('"+r+"')");e=this.$el.find(".state-under");this.$el.append(n);t=function(){var r;if(Modernizr.csstransitions)return app.animate({element:n,cssClass:"state-in",complete:function(){e.remove();$(n).removeClass("state-over").addClass("state-under");return i.events.trigger("background.imageSet")}});r=i.events;t=function(t){e.remove();$(t).removeClass("state-over").addClass("state-under");return r.trigger("background.imageSet")};return $(n).animate({opacity:1},{duration:1e3,complete:function(){return t(this)}})};setTimeout(t,500);return this};t.prototype.setupTimeout=function(){var e,t=this;e=function(){t.index=t.index+1===t.imagesUrl.length?0:t.index+1;t.setImage();return null};_.delay(e,this.delay);return this};t.prototype.enter=function(){var e,t=this;if(Modernizr.cssanimations)app.animate({element:this.$el[0],cssClass:"state-in",complete:function(){return t.events.trigger("region.entered",[t])}});else{this.$el.animate({opacity:1},{duration:500,complete:function(){return t.events.trigger("region.entered",[t])}});e=function(){return t.events.trigger("region.entered",[t])};_.delay(e)}return this};t.prototype.exit=function(){var e,t=this;if(Modernizr.cssanimations)app.animate({element:this.$el[0],cssClass:"state-out",complete:function(){t.events.trigger("region.quitted",[t]);t.events.clear();return t.$el.remove()}});else{e=function(){t.events.trigger("region.quitted",[t]);t.events.clear();return t.$el.remove()};this.$el.animate({opacity:0},{duration:500,complete:function(){return e()}})}return this};return t}(Region);RegionMenu=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){var e=this;this.$menu=this.$el.find("> * > ul");this.events.on("view.enter",function(){return e.listSelect()});this.setSubMenus();return this};t.prototype.setSubMenus=function(e){var t=this;e===void 0&&(e=this.$menu);e.find("> li").each(function(e,t){var n,r,i;i=$(t).find("> ul")[0];if(_.isElement(i)){n=$(i);r=n.height()*-1;return n.css("top",r)}});return this};t.prototype.listSelect=function(){var e,t,n,r,i,s;this.$menu.find("li.nav-sel").removeClass("nav-sel");this.$menu.find("li.nav-item-sel").removeClass("nav-item-sel");s=window.location.href;e=this.$el.find("a[href='"+s+"']");if(e.length){i=null;r=!1;t=e;while(!r){n=t[0].tagName;n==="LI"&&(i=t);t=t.parent();t.attr("data-region")&&(r=!0)}i.addClass("nav-sel");e.parent().addClass("nav-item-sel")}return this};return t}(Region);RegionPage=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){this.$title=this.$el.find("> h1:eq(0)");this.$content=this.$el.find("> .page-content:eq(0)");this.$thumb=this.$el.find("#page-featured img");return this};t.prototype.enter=function(){var e=this;this.$thumb.length&&app.utils.imagePreload(this.$thumb[0],function(t){return Modernizr.cssanimations?app.animate({element:e.$thumb[0],cssClass:"state-loaded"}):e.$thumb.animate({opacity:1},{duration:500})});if(Modernizr.cssanimations){app.animate({element:this.$title[0],cssClass:"state-in"});app.animate({element:this.$content[0],cssClass:"state-in",complete:function(){return e.events.trigger("region.entered",[e])}})}else{this.$title.animate({opacity:1},{duration:500});this.$content.animate({opacity:1},{duration:500,complete:function(){return e.events.trigger("region.entered",[e])}})}return this};t.prototype.exit=function(){var e=this;if(Modernizr.cssanimations){app.animate({element:this.$title[0],cssClass:"state-out"});app.animate({element:this.$content[0],cssClass:"state-out",complete:function(){e.events.trigger("region.quitted",[e]);return e.events.clear()}})}else{this.$title.animate({opacity:0},{duration:500});this.$content.animate({opacity:0},{duration:500,complete:function(){e.events.trigger("region.quitted",[e]);return e.events.clear()}})}return this};return t}(Region);RegionSidebar=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.enter=function(){var e=this;Modernizr.cssanimations?app.animate({element:this.$el[0],cssClass:"state-in",complete:function(){return e.events.trigger("region.entered",[e])}}):this.$el.animate({opacity:1},{duration:500,complete:function(){return e.events.trigger("region.entered",[e])}});return this};t.prototype.exit=function(){var e,t=this;if(Modernizr.cssanimations){e=this.$el.css("display");if(e==="none"){this.events.trigger("region.quitted",[this]);this.events.clear()}app.animate({element:this.$el[0],cssClass:"state-out",complete:function(){t.events.trigger("region.quitted",[t]);return t.events.clear()}})}else this.$el.animate({opacity:0},{duration:500,complete:function(){t.events.trigger("region.quitted",[t]);return t.events.clear()}});return this};return t}(Region);RegionHome=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){var e=this;this.$boxes=this.$el.find(".home-box");this.$buttonNews=this.$el.find("#home-news-display");this.$claimMessage=this.$el.find("#home-claim h1 span");this.$claimButton=this.$el.find("#home-claim h1 a");this.events.on("page.toggleAside",function(){return e.toggleAside()});this.$buttonNews.length&&this.$buttonNews.on("click",function(t){return e.events.trigger("page.toggleAside")});return this};t.prototype.toggleAside=function(){var e;this.$el.hasClass("state-translate")?app.events.trigger("page.asideIn"):app.events.trigger("page.asideOut");if(Modernizr.cssanimations)app.animate({element:this.$el[0],cssClass:"state-translate"});else{e={duration:500,easing:"swing"};if(this.$el.hasClass("news-displayed")){this.$el.removeClass("news-displayed");this.$el.animate({left:0},e)}else{this.$el.animate({left:-300},e);this.$el.addClass("news-displayed")}}return this};t.prototype.enter=function(){var e,t,n,r,i=this;this.$buttonNews.length&&(Modernizr.cssanimations?app.animate({element:this.$buttonNews[0],cssClass:"state-in"}):this.$buttonNews.fadeIn(500));if(this.$claimMessage.length)if(Modernizr.cssanimations)app.animate({element:this.$claimMessage[0],cssClass:"state-in",complete:function(){return i.events.trigger("region.entered",[i])}});else{r=function(){return i.$claimMessage.animate({opacity:1},{duration:1e3})};_.delay(r,1e3)}if(this.$claimButton.length)if(Modernizr.cssanimations)app.animate({element:this.$claimButton[0],cssClass:"state-in",complete:function(){if(i.$boxes.length===0&&i.$claimMessage.length===0)return i.events.trigger("region.entered",[i])}});else{e=function(){return i.$claimButton.animate({opacity:1},{duration:1500})};_.delay(e,1500)}if(this.$boxes.length){t=350;n=0;Modernizr.cssanimations?this.$boxes.each(function(e,r){var s;s=function(){return app.animate({element:r,cssClass:"state-in",complete:function(){if(e===i.$boxes.length-1&&i.$claimMessage.length===0)return i.events.trigger("region.entered",[i])}})};_.delay(s,n);return n+=t}):this.$boxes.each(function(e,r){var s;s=function(){return $(r).animate({opacity:1},{duration:500,complete:function(){if(e===i.$boxes.length-1)return i.events.trigger("region.entered",[i])}})};_.delay(s,n);return n+=t})}this.$claimMessage.length===0&&this.$boxes.length===0&&this.$claimButton.length===0&&this.events.trigger("region.entered",[this]);return this};t.prototype.exit=function(){var e,t,n=this;this.$el.removeClass("state-translate");this.$buttonNews.length&&(Modernizr.cssanimations?app.animate({element:this.$buttonNews[0],cssClass:"state-out"}):this.$buttonNews.fadeOut(500));this.$claimMessage.length&&(Modernizr.cssanimations?app.animate({element:this.$claimMessage[0],cssClass:"state-out"}):this.$claimMessage.fadeOut(500));this.$claimButton.length&&(Modernizr.cssanimations?app.animate({element:this.$claimButton[0],cssClass:"state-out"}):this.$claimButton.fadeOut(500));if(this.$boxes.length){e=250;t=0;Modernizr.cssanimations?this.$boxes.each(function(r,i){var s;s=function(){return app.animate({element:i,cssClass:"state-out",complete:function(){if(r===n.$boxes.length-1){n.events.trigger("region.quitted",[n]);return n.events.clear()}}})};_.delay(s,t);return t+=e}):this.$boxes.each(function(r,i){var s;s=function(){return $(i).animate({opacity:0},{duration:500,complete:function(){if(r===n.$boxes.length-1){n.events.trigger("region.quitted",[n]);return n.events.clear()}}})};_.delay(s,t);return t+=e})}else{this.events.trigger("region.quitted",[this]);this.events.clear()}return this};return t}(Region);RegionAside=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){var e=this;app.events.on("page.toggleAside",function(){return e.toggle()});app.events.on("view.exit",function(){if(e.$el.hasClass("state-translate"))return e.toggle()});return this};t.prototype.toggle=function(){var e;if(Modernizr.cssanimations)app.animate({element:this.$el[0],cssClass:"state-translate"});else{e={duration:500,easing:"swing"};if(this.$el.hasClass("news-displayed")){this.$el.removeClass("news-displayed");this.$el.animate({right:-300},e)}else{this.$el.animate({right:0},e);this.$el.addClass("news-displayed")}}return this};return t}(Region);RegionGallery=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){var e=this;this.$loader=this.$el.find("#gallery-loader");this.$imageContainer=this.$el.find("#gallery-image-container");this.$caption=this.$el.find("#gallery-image-caption");this.$buttonNext=this.$el.find("#gallery-button-next");this.$buttonPrev=this.$el.find("#gallery-button-prev");this.$title=this.$el.find("h1");this.$swipe=this.$el.find("#gallery-image-swipe");typeof mthemes_gallery_images!="undefined"&&_.isArray(mthemes_gallery_images)&&this.loadImages();this.events.on("gallery.imageLoaded",function(){return e.$loader.text(""+e.percent+"%")});this.events.on("gallery.galleryLoaded",function(){return e.buildGallery()});this.events.on("gallery.next",function(){return e.next()});this.events.on("gallery.prev",function(){return e.prev()});this.$buttonNext.hammer().on("tap",function(){return e.events.trigger("gallery.next")});this.$buttonPrev.hammer().on("tap",function(){return e.events.trigger("gallery.prev")});this.$swipe.hammer().on("swipeleft",function(){return e.events.trigger("gallery.next")});this.$swipe.hammer().on("swiperight",function(){return e.events.trigger("gallery.previous")});return this};t.prototype.next=function(){this.timeout&&clearTimeout(this.timeout);this.index=this.index+1<this.images.length?this.index+1:0;this.direction=1;this.setImage();return this};t.prototype.prev=function(){this.timeout&&clearTimeout(this.timeout);this.index=this.index-1<0?this.images.length-1:this.index-1;this.direction=0;this.setImage();return this};t.prototype.loadImages=function(){var e,t,n=this;this.images=mthemes_gallery_images;this.index=0;this.percent=0;e=function(e,n){return app.utils.imagePreload(e.src,t)};t=function(){n.index++;n.percent=Math.ceil(100/n.images.length*n.index);n.events.trigger("gallery.imageLoaded");if(n.index===n.images.length)return n.events.trigger("gallery.galleryLoaded")};_.each(this.images,e);return this};t.prototype.buildGallery=function(){var e,t=this;if(Modernizr.cssanimations)app.animate({element:this.$loader[0],cssClass:"state-out",complete:function(){return $(this).parent().remove()}});else{e=function(){return t.$loader.parent().remove()};this.$loader.fadeOut(500,e)}this.delay=typeof mthemes_gallery_images_delay!="undefined"&&_.isNumber(mthemes_gallery_images_delay)?mthemes_gallery_images_delay:7500;this.autoplay=typeof mthemes_gallery_autoplay!="undefined"&&mthemes_gallery_autoplay?mthemes_gallery_autoplay:!1;this.stop=!1;this.index=0;this.timeout=null;this.direction=1;this.setImage(this.autoplay);return this};t.prototype.setImage=function(e){var t,n,r,i,s,o=this;e==null&&(e=!0);if(!this.stop){this.stop=!0;s=this.images[this.index];t=$("<span>").addClass("gallery-image-new").addClass("state-init").css("background-image","url('"+s.src+"')");this.$imageContainer.append(t);r=function(e,t,n){$(n).parent().find("span").not(".gallery-image-new").remove();$(n).removeClass("gallery-image-new");return o.stop=!1};i=function(){o.index=o.index+1<o.images.length?o.index+1:0;o.direction=1;return o.setImage()};n=function(){if(s.caption!==""){o.$caption.text(s.caption);return Modernizr.cssanimations?app.animate({element:o.$caption[0],cssClass:"state-out"}):o.$caption.animate({opacity:1},{duration:500})}};this.$caption.hasClass("state-out")?n():Modernizr.cssanimations?app.animate({element:this.$caption[0],cssClass:"state-out",complete:function(){return n()}}):this.$caption.animate({opacity:0},{duration:500,complete:function(){return n()}});Modernizr.cssanimations?app.animate({element:t,cssClass:this.direction===1?"state-in-left":"state-in-right",complete:r}):t.animate({opacity:1},{duration:500,complete:r});e&&(this.timeout=_.delay(i,this.delay))}return this};t.prototype.enter=function(){var e=this;Modernizr.cssanimations?app.animate({element:this.$title[0],cssClass:"state-in",complete:function(
){return e.events.trigger("region.entered",[e])}}):this.$title.animate({opacity:1},{duration:500,complete:function(){return e.events.trigger("region.entered",[e])}});return this};t.prototype.exit=function(){var e=this;if(Modernizr.cssanimations){app.animate({element:this.$title[0],cssClass:"state-out"});app.animate({element:this.$imageContainer[0],cssClass:"state-out",complete:function(){e.events.trigger("region.quitted",[e]);return e.events.clear()}})}else{this.$title.fadeOut(500);this.$imageContainer.fadeOut(500,function(){e.events.trigger("region.quitted",[e]);return e.events.clear()})}return this};return t}(Region);RegionCollection=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){var e=this;this.$title=this.$el.find("h1");this.$content=this.$el.find("#collection-content");this.$container=this.$el.find("#collection-container");this.$elements=this.$el.find(".collection-item");this.$elementsContent=this.$elements.find(".collection-item-content");this.$tagsTitle=this.$el.find("#collection-tags-title");this.$tags=this.$el.find("#collection-tags-list");this.$tagsLi=this.$tags.find("li");this.$content.isotope({itemSelector:".collection-item",layoutMode:"masonry"});this.$elements.each(function(e,t){var n,r,i;n=$(t);r=n.find("img.collection-item-thumb");if(r.length){i=r.attr("src");return app.utils.imagePreload(i,function(e){var r;if(Modernizr.cssanimations)return app.animate({element:t,cssClass:"state-fade-out",complete:function(){n.css("background-image","url('"+e+"')");return app.animate({element:t,cssClass:"state-fade-in"})}});r=function(){n.css("background-image","url('"+e+"')");return n.animate({opacity:1},{duration:500})};return n.animate({opacity:0},{duration:500,complete:r})})}});this.$tagsLi.hammer().on("tap",function(t){return e.setFilter($(t.target).attr("data-slug"))});return this.filter=null};t.prototype.setFilter=function(e){if(e!==this.filter){this.filter=e==="*"?e:".tag-"+e;this.$tagsLi.removeClass("collection-tags-list-sel");this.$tagsLi.filter("[data-slug='"+e+"']").addClass("collection-tags-list-sel");this.$content.isotope({filter:this.filter})}return this};t.prototype.enter=function(){var e,t,n=this;Modernizr.cssanimations?app.animate({element:this.$title[0],cssClass:"state-in"}):this.$title.animate({opacity:1},{duration:500});Modernizr.cssanimations?app.animate({element:this.$tagsTitle[0],cssClass:"state-in"}):this.$tagsTitle.animate({opacity:1},{duration:500});Modernizr.cssanimations?app.animate({element:this.$tags[0],cssClass:"state-in"}):this.$tags.animate({opacity:1},{duration:500});e=200;t=0;this.$elements.each(function(r,i){var s;i=$(i).find(".collection-item-content");s=function(){return Modernizr.cssanimations?app.animate({element:i,cssClass:"state-in",complete:function(){if(r===n.$elements.length-1)return n.events.trigger("region.entered",[n])}}):$(i).animate({opacity:1},{duration:1e3,complete:function(){if(r===n.$elements.length-1)return n.events.trigger("region.entered",[n])}})};_.delay(s,t);return t+=e});return this};t.prototype.exit=function(){var e,t=this;Modernizr.cssanimations?app.animate({element:this.$title[0],cssClass:"state-out"}):this.$title.animate({opacity:0},{duration:700});Modernizr.cssanimations?app.animate({element:this.$tagsTitle[0],cssClass:"state-out"}):this.$tagsTitle.animate({opacity:0},{duration:700});Modernizr.cssanimations?app.animate({element:this.$tags[0],cssClass:"state-out"}):this.$tags.animate({opacity:0},{duration:700});if(Modernizr.cssanimations)app.animate({element:this.$container[0],cssClass:"state-out",complete:function(){t.events.trigger("region.quitted",[t]);return t.events.clear()}});else{e=function(){t.events.trigger("region.quitted",[t]);return t.events.clear()};this.$container.animate({opacity:0},{duration:500,complete:e})}return this};return t}(Region);RegionBlog=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){var e,t=this;this.$content=this.$el.find("#blog-content");this.$articles=this.$el.find("article");this.$buttons=this.$el.find(".blog-button");this.$bar=this.$el.find("#blog-content-bar");this.$pagination=this.$el.find("#blog-pagination");this.$title=this.$bar.find("h1");e=function(e){var n;n=e.target.tagName.toLowerCase();while(n!=="span"){e.target=$(e.target).parent()[0];n=e.target.tagName.toLowerCase()}return t.move(e)};this.$buttons.hammer().on("tap",e);return this};t.prototype.move=function(e){var t,n,r,i,s;n=$(e.target);i=n.attr("id")==="blog-button-up"?0:1;t=this.$el.find("article.blog-list-active");r=i===1?t.next():t.prev();if(r.length===1&&r[0].tagName.toLowerCase()==="article"){s=r.position();t.removeClass("blog-list-active");r.addClass("blog-list-active");Modernizr.cssanimations?this.$bar.css("top",s.top*-1):this.$bar.animate({top:s.top*-1},{duration:500})}return this};t.prototype.enter=function(){var e,t,n,r,i=this;n=200;r=0;e=function(e,t){var s;s=function(){return Modernizr.cssanimations?app.animate({element:t,cssClass:"state-in",complete:function(){if(e===i.$articles.length-1)return i.events.trigger("region.entered",[i])}}):$(t).animate({opacity:1},{duration:500,complete:function(){if(e===i.$articles.length-1)return i.events.trigger("region.entered",[i])}})};_.delay(s,r);return r+=n};t=function(e,t){return Modernizr.cssanimations?app.animate({element:t,cssClass:"state-in"}):$(t).animate({opacity:1},{duration:500})};Modernizr.cssanimations?app.animate({element:this.$title[0],cssClass:"state-in"}):this.$title.animate({opacity:1},{duration:500});this.$pagination.length&&(Modernizr.cssanimations?app.animate({element:this.$pagination[0],cssClass:"state-in"}):this.$pagination.animate({opacity:1},{duration:500}));this.$buttons.each(t);this.$articles.find(".blog-list-content").each(e);return this};t.prototype.exit=function(){var e,t,n,r,i=this;n=200;r=0;e=function(e,t){var s;s=function(){var n;if(Modernizr.cssanimations)return app.animate({element:t,cssClass:"state-out",complete:function(){if(e===i.$articles.length-1){i.events.trigger("region.quitted",[i]);return i.events.clear()}}});n=function(){if(e===i.$articles.length-1){i.events.trigger("region.quitted",[i]);return i.events.clear()}};return $(t).animate({opacity:0},{duration:500,complete:function(){return n()}})};_.delay(s,r);return r+=n};t=function(e,t){return app.animate({element:t,cssClass:"state-out"})};Modernizr.cssanimations?app.animate({element:this.$title[0],cssClass:"state-out"}):this.$title.animate({opacity:0},{duration:500});this.$pagination.length&&app.animate({element:this.$pagination[0],cssClass:"state-out"});this.$buttons.each(t);this.$articles.find(".blog-list-content").each(e);return this};return t}(Region);RegionVideo=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){this.$title=this.$el.find("h1");this.$video=this.$el.find("#video-content");return this};t.prototype.enter=function(){var e=this;if(Modernizr.cssanimations){app.animate({element:this.$title[0],cssClass:"state-in"});app.animate({element:this.$video[0],cssClass:"state-in",complete:function(){return e.events.trigger("region.entered",[e])}})}else{this.$title.animate({opacity:1},{duration:500});this.$video.animate({opacity:1},{duration:500})}return this};t.prototype.exit=function(){var e,t=this;if(Modernizr.cssanimations){app.animate({element:this.$title[0],cssClass:"state-out"});app.animate({element:this.$video[0],cssClass:"state-out",complete:function(){t.events.trigger("region.quitted",[t]);return t.events.clear()}})}else{e=function(){t.events.trigger("region.quitted",[t]);return t.events.clear()};this.$title.animate({opacity:0},{duration:500});this.$video.animate({opacity:0},{duration:500,complete:e})}return this};return t}(Region);RegionHalfpage=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){this.$title=this.$el.find("h1");this.$container=this.$el.find("#half-page-container");this.$column1=this.$el.find("#half-page-column-1");this.$column2=this.$el.find("#half-page-column-2");return this};t.prototype.enter=function(){var e=this;if(Modernizr.cssanimations){app.animate({element:this.$title[0],cssClass:"state-in"});app.animate({element:this.$column1[0],cssClass:"state-in"});app.animate({element:this.$column2[0],cssClass:"state-in",complete:function(){return e.events.trigger("region.entered",[e])}})}else{this.$title.animate({opacity:1},{duration:500});this.$column1.animate({opacity:1},{duration:500});this.$column2.animate({opacity:1},{duration:500})}return this};t.prototype.exit=function(){var e,t=this;if(Modernizr.cssanimations){app.animate({element:this.$title[0],cssClass:"state-out"});app.animate({element:this.$column1[0],cssClass:"state-out"});app.animate({element:this.$column2[0],cssClass:"state-out",complete:function(){t.events.trigger("region.quitted",[t]);return t.events.clear()}})}else{e=function(){t.events.trigger("region.quitted",[t]);return t.events.clear()};this.$title.animate({opacity:0},{duration:500});this.$column1.animate({opacity:0},{duration:500});this.$column2.animate({opacity:0},{duration:500,complete:e})}return this};return t}(Region);RegionSocials=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){var e=this;this.events.on("viewport.resize",function(){return e.switchDisplay()});return this};t.prototype.switchDisplay=function(){var e,t=this;e=function(){var e,n,r,i,s,o,u;e=t.$el.parent();if(!(e.position().top>100))return t.$el.css("display","none");n=e.find("#footer-menu > * > ul");i=e.attr("class")?e.attr("class").split(" "):[];s=e.width()/2;o=0;u=t.$el.width();n.find("li").each(function(e,t){return o+=$(t).width()+1});if(i.length>0){r=e.find("#audioplayer").width();r+u+o>s?t.$el.css("display","none"):t.$el.css("display","block")}if(i.length===0)return u+o>s?t.$el.css("display","none"):t.$el.css("display","block")};_.delay(e,100);return this};return t}(Region);RegionLoader=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}__extends(t,e);t.prototype.init=function(){var e=this;this.events.on("view.quitted",function(){return e.display()});this.events.on("view.enter",function(){return e.hide()});return this};t.prototype.display=function(){this.$el.removeClass().addClass("loader-display");return this};t.prototype.hide=function(){this.$el.removeClass().addClass("loader-hide");return this};return t}(Region)}).call(this);